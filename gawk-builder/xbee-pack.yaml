schema-version: 1.0

type: builder


const:
  srcDir: /usr/src
  exportDir: /opt/gawk

provision:
  - url:
      from: https://ftp.gnu.org/gnu/gawk/gawk-{% version %}.tar.xz
      todir: "{% srcDir %}"

build:
  - shell:
      cmds:
        - sed -i 's/extras//' Makefile.in
        - ./configure --prefix=/usr
        - make
#        - make check
        - make install DESTDIR={% exportDir %}
        - mkdir -pv {% exportDir %}/usr/share/doc/gawk-{% version %}
        - cp    -v doc/{awkforai.txt,*.{eps,pdf,jpg}} {% exportDir %}/usr/share/doc/gawk-{% version %}
      directory: "{% srcDir %}/gawk-{% version %}"
  - export: "{% exportDir %}"

